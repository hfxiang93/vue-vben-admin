import{i as t,e,c as n,w as a}from"./index.8bfaff0d.js";import{B as u,C as o,a7 as r,j as s,a4 as l,b5 as i,K as c,t as d,u as v,r as f,a0 as p,k as m,aN as C,L as y,n as S,q as b,Q as g,O as x,_ as h,y as w,x as B}from"./vendor.5450320c.js";function z(t,e="value",n="change",a){const f=l(),p=null==f?void 0:f.emit,m=u({value:t[e]}),C=o(m);r((()=>{m.value=t[e]}));return[s({get:()=>m.value,set(t){i(t,C.value)||(m.value=t,c((()=>{null==p||p(n,t,...d(v(a))||[])})))}}),t=>{m.value=t},C]}var F=m({name:"CountButton",components:{Button:C},props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(n){const a=f(!1),{currentCount:u,isStart:o,start:l,reset:i}=function(t){const e=f(t),n=f(!1);let a;function u(){a&&window.clearInterval(a)}function o(){n.value=!1,u(),a=null}function r(){v(n)||a||(n.value=!0,a=setInterval((()=>{1===v(e)?(o(),e.value=t):e.value-=1}),1e3))}function s(){e.value=t,o()}return p((()=>{s()})),{start:r,reset:s,restart:function(){s(),r()},clear:u,stop:o,currentCount:e,isStart:n}}(n.count),{t:c}=e(),d=s((()=>v(o)?c("component.countdown.sendText",[v(u)]):c("component.countdown.normalText")));return r((()=>{void 0===n.value&&i()})),{handleStart:function(){return e=this,u=null,o=function*(){const{beforeStartFunc:e}=n;if(e&&t(e)){a.value=!0;try{(yield e())&&l()}finally{a.value=!1}}else l()},new Promise(((t,n)=>{var a=t=>{try{s(o.next(t))}catch(e){n(e)}},r=t=>{try{s(o.throw(t))}catch(e){n(e)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,r);s((o=o.apply(e,u)).next())}));var e,u,o},currentCount:u,loading:a,getButtonText:d,isStart:o}}});F.render=function(t,e,n,a,u,o){const r=y("Button");return S(),b(r,x(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:g((()=>[h(w(t.getButtonText),1)])),_:1},16,["disabled","onClick","loading"])};var A=m({name:"CountDownInput",components:{CountButton:F},inheritAttrs:!1,props:{value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:e}=n("countdown-input"),[a]=z(t);return{prefixCls:e,state:a}}});A.render=function(t,e,n,a,u,o){const r=y("CountButton"),s=y("a-input");return S(),b(s,x(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),{addonAfter:g((()=>[B(r,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:1},16,["class","size","value"])};const j=a(A);a(F);export{j as C,z as u};
