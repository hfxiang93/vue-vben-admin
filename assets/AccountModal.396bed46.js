var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,i=(e,t)=>{for(var o in t||(t={}))r.call(t,o)&&l(e,o,t[o]);if(a)for(var o of a(t))n.call(t,o)&&l(e,o,t[o]);return e},s=(e,t,o)=>new Promise(((a,r)=>{var n=e=>{try{i(o.next(e))}catch(t){r(t)}},l=e=>{try{i(o.throw(e))}catch(t){r(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,l);i((o=o.apply(e,t)).next())}));import{B as d,a as c}from"./index.fa9a22d0.js";import{_ as p}from"./BasicForm.8e0e03ac.js";import{u}from"./useForm.b79f2c59.js";import{b as m,a as f}from"./system.d12d6024.js";import{k as b,r as g,j as h,u as v,L as y,n as w,q as P,Q as I,x as O,O as j}from"./vendor.5450320c.js";const x=[{title:"用户名",dataIndex:"account",width:120},{title:"昵称",dataIndex:"nickname",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"角色",dataIndex:"role",width:200},{title:"备注",dataIndex:"remark"}],F=[{field:"account",label:"用户名",component:"Input",colProps:{span:8}},{field:"nickname",label:"昵称",component:"Input",colProps:{span:8}}],k=[{field:"account",label:"用户名",component:"Input",required:!0},{field:"pwd",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"role",component:"ApiSelect",componentProps:{api:m,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"所属部门",component:"TreeSelect",componentProps:{replaceFields:{title:"deptName",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"昵称",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}];var S=b({name:"AccountModal",components:{BasicModal:d,BasicForm:p},emits:["success","register"],setup(e,{emit:a}){const r=g(!0),n=g(""),[l,{setFieldsValue:d,updateSchema:p,resetFields:m,validate:b}]=u({labelWidth:100,schemas:k,showActionButtonGroup:!1,actionColOptions:{span:23}}),[y,{setModalProps:w,closeModal:P}]=c((e=>s(this,null,(function*(){m(),w({confirmLoading:!1}),r.value=!!(null==e?void 0:e.isUpdate),v(r)&&(n.value=e.record.id,d(i({},e.record)));const t=yield f();p([{field:"pwd",show:!v(r)},{field:"dept",componentProps:{treeData:t}}])}))));return{registerModal:y,registerForm:l,getTitle:h((()=>v(r)?"编辑账号":"新增账号")),handleSubmit:function(){return s(this,null,(function*(){try{const s=yield b();w({confirmLoading:!0}),P(),a("success",{isUpdate:v(r),values:(e=i({},s),l={id:n.value},t(e,o(l)))})}finally{w({confirmLoading:!1})}var e,l}))}}}});S.render=function(e,t,o,a,r,n){const l=y("BasicForm"),i=y("BasicModal");return w(),P(i,j(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:I((()=>[O(l,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var M=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:S});export{M as A,S as _,x as c,F as s};
